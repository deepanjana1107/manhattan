<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Manhattan by deepanjana1107</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Manhattan</h1>
        <h2>Open Source Geo Project Manhattan</h2>
        <a href="https://github.com/deepanjana1107/manhattan" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="manhattan-tourist-itinerary" class="anchor" href="#manhattan-tourist-itinerary" aria-hidden="true"><span class="octicon octicon-link"></span></a>Manhattan Tourist Itinerary</h1>

<p>The Manhattan Tourist Itinerary project (called 'Manhattan' in short) has been created in ExtJS’ MVC (Model-View-Controller) programming style. It is built with the following components.</p>

<ul>
<li>Server Side

<ul>
<li>PostGIS 2.1 with PostgreSQL 9.3 with pgRouting 2</li>
<li>GeoServer 2.5</li>
<li>PHP </li>
</ul>
</li>
<li>
<p>Client Side</p>

<ul>
<li>OpenLayers 2.13.1</li>
<li>GeoExt 2.0.2</li>
<li>ExtJS 4.2</li>
</ul>
</li>
<li>
<p>Folder Structure</p>

<ul>
<li>'app': stores the relevant model, view, controller files. For the 'Manhattan' application, no model is used</li>
<li>'library': stores the relevant OpenLayers 2, GeoExt 2, and Ext.JS library files</li>
<li>'resources': contains client application relevant non-JavaScript files such as images (of manhattan), map help, navigation help, etc.

<ul>
<li>A PHP file (route_multiple.php) inside the resources folder is used by the application to access pgRouting</li>
</ul>
</li>
<li>'database': contains two database dump files which can be used to set up the database </li>
</ul>
</li>
</ul>

<p>Authors: Franziska Blumenschein &amp; Deepanjana Majumdar</p>

<h2>
<a id="how-to-load-manhattan-client-application-in-apache-httpd-web-server" class="anchor" href="#how-to-load-manhattan-client-application-in-apache-httpd-web-server" aria-hidden="true"><span class="octicon octicon-link"></span></a>How to load ‘Manhattan’ client application in Apache httpd web server</h2>

<ul>
<li>The application has been tested with Apache httpd 2.4.7</li>
<li>Clone this repository into your local folder (say, 'Manhattan')</li>
<li>Copy the ‘Manhattan’ folder in /var/www/html folder of OSGeo-Live</li>
<li>The index.html within 'Manhattan' will be visible in the browser at location http://localhost:80/manhattan/ (localhost/manhattan as shortcut)</li>
<li>If you want to create more advanced or virtual locations, then create a new configuration in /etc/apache2/conf-available folder</li>
</ul>

<h2>
<a id="setting-up-the-server-side" class="anchor" href="#setting-up-the-server-side" aria-hidden="true"><span class="octicon octicon-link"></span></a>Setting up the Server Side</h2>

<p>If you are using OSGeo Live, then the following components are already enabled for you. If not, please set these up individually.</p>

<ul>
<li><p>A PostgreSQL database containing different tables that store geometry data (‘features’) corresponding to the different ‘layers’ are displayed in the ‘Manhattan’ client</p></li>
<li><p>pgRouting extension has been added (by default) to PostgreSQL database. The ‘ways’ table is pgRouting geometry (the_geom) enabled which is returned to the client application (‘Manhattan’) via PHP</p></li>
<li><p>GeoServer is the WMS service provider. It exposes the different PostgreSQL tables to the ‘Manhattan’ application via WMS calls (in OSGeo Live via http://localhost:8082)</p></li>
</ul>

<h2>
<a id="steps-in-preparing-the-data" class="anchor" href="#steps-in-preparing-the-data" aria-hidden="true"><span class="octicon octicon-link"></span></a>Steps in Preparing the Data</h2>

<ul>
<li><p>Get data from weogeo market (<a href="http://market.weogeo.com/datasets/osm-openstreetmap-new-york-ny-metro-region">http://market.weogeo.com/datasets/osm-openstreetmap-new-york-ny-metro-region</a>), here all needed layers are available
Needed layers (as ESRI shapefile): highway (streets), leisure (parks), tourism (museums), buildings, amenity (theatres)</p></li>
<li><p>Clip data to Manhattan boundaries</p></li>
<li><p>Clean up data, remove unnecessary attributes (necessary: ID, geom, name)</p></li>
<li><p>Create the following layers: theatre_poly (theatre polygons), buildins_poly (important buildings polygon features), theatre (theatre point features), 
museums (museums point features), Manhattan_parks (park polygon features), museum_poly (museum polygon features)</p></li>
<li><p>Modify the data, add the homepage and address columns and fill them manually either via pgAdmin or QGIS</p></li>
<li><p>Style layers in QGIS and store them as .sld files</p></li>
<li><p>Add layers to your PostGIS database</p></li>
<li>
<p>Publish layers from the PostGIS database on Geoserver</p>

<ul>
<li>Create a workspace called "tour_manhattan"</li>
<li>Create a store called "manhattan"</li>
<li>Add the layers described under point 4</li>
<li>Load the .sld files under style in GeoServer</li>
</ul>
</li>
</ul>

<p>Otherwise the database dump (database_dump.sql), which is also used as a backup, is containing all needed layers. It gives the opportunity to recreate the complete database within a SQL query, so the user only needs to publish these database tables.</p>

<h2>
<a id="pgrouting" class="anchor" href="#pgrouting" aria-hidden="true"><span class="octicon octicon-link"></span></a>PgRouting</h2>

<p>In order to provide the user a routing functionality the following steps need to be done. For further questions the FOSS4G workshop "Routing with pgRouting" provides further information.</p>

<ul>
<li><a href="http://download.osgeo.org/pgrouting/foss4g2010/workshop/docs/pgRoutingWorkshop.pdf">http://download.osgeo.org/pgrouting/foss4g2010/workshop/docs/pgRoutingWorkshop.pdf</a></li>
<li><a href="http://workshop.pgrouting.org/chapters/php_server.html">http://workshop.pgrouting.org/chapters/php_server.html</a></li>
</ul>

<ul>
<li><p>Create database "routing" in PostgreSQL </p></li>
<li>
<p>Add postgis and pgRouting extension to the database (see workshop chapter 3.3)
(-- add PostGIS functions
  CREATE EXTENSION postgis;</p>

<p>-- add pgRouting core functions
  CREATE EXTENSION pgrouting;)</p>
</li>
<li><p>Create a connection between this database and QGIS (Add PostGIS Table in QGIS)</p></li>
<li>
<p>Layer highway (only the lines are needed):</p>

<ul>
<li><p>change CRS from EPSG 3857 (WGS84 Web Mercator) to 4326 (WGS 84 / Latlong) after loading the data to QGIS</p></li>
<li><p>Explode lines (f.e. with QGIS Processing Toolbox: Geoalgorithms -&gt; Vector geom tools -&gt; Explode lines. 
This step is necessary to create junctions wherever streets will intersect. Otherwise streets will only intersect in the start and end point.</p></li>
<li><p>Add new columns to the attribute table: -&gt; gid (=$id)
                  -&gt; length (=$length)
                  -&gt; the_geom (=$geom)</p></li>
<li><p>Use QGIS DB Manager to add .shp-file layer as table "ways" to the PostGIS database. Choose target SRID 4326, create a spatial index, create single-part geometries 
instead of multi-part and the_geom as the geometry column</p></li>
<li><p>Run query "UPDATE ways SET the_geom = ST_Force_2D(geom)"</p></li>
</ul>
</li>
<li><p>Follow the further instructions in the PgRouting workshop from FOSS4G (<a href="http://workshop.pgrouting.org/chapters/topology.html">http://workshop.pgrouting.org/chapters/topology.html</a>) with chapter 4 (Create a Network Topology) and chapter 5 (PgRouting Algorithms)</p></li>
</ul>

<p>After following this instructions the network topology is implemented and together with the published layers on geoserver and the provided codes the application should work.</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/deepanjana1107/manhattan/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/deepanjana1107/manhattan/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/deepanjana1107/manhattan"></a> is maintained by <a href="https://github.com/deepanjana1107">deepanjana1107</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
